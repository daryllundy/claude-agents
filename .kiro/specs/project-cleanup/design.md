# Design Document

## Overview

This design outlines the approach for cleaning up and organizing the claude-agents repository. The cleanup will remove unnecessary files, consolidate redundant documentation, organize test scripts, and ensure the project follows best practices for repository structure.

## Architecture

### Cleanup Strategy

The cleanup will follow a phased approach:

1. **Analysis Phase**: Identify all files to be removed, moved, or consolidated
2. **Consolidation Phase**: Merge redundant documentation into appropriate locations
3. **Organization Phase**: Move misplaced files to correct directories
4. **Cleanup Phase**: Remove unnecessary files and directories
5. **Verification Phase**: Update .gitignore and verify git tracking

### File Classification

Files are classified into four categories:

- **Remove**: Files that serve no purpose and should be deleted
- **Move**: Files in wrong locations that should be relocated
- **Consolidate**: Content that should be merged into existing files
- **Keep**: Files that are properly located and necessary

## Components and Interfaces

### Component 1: Root Directory Cleanup

**Purpose**: Clean up the root directory by removing temporary and unnecessary files

**Files to Remove**:
- `TODO.md` - Contains only completed items, no longer needed
- `IMPLEMENTATION_SUMMARY.md` - Temporary development documentation
- `SURFACE_USE_CASE_COMPLETION_SUMMARY.md` - Temporary development documentation
- `.DS_Store` - macOS system file (should be gitignored)
- Test scripts in root (to be moved, not removed)

**Files to Move**:
- `test_pattern_loading.sh` → `tests/integration/`
- `test_use_case_metadata.sh` → `tests/integration/`
- `test_use_case_simple.sh` → `tests/integration/`
- `test_yaml_parser.sh` → `tests/unit/`

**Rationale**: Root directory should contain only essential documentation and configuration files. Test scripts belong in the tests directory for better organization.

### Component 2: Documentation Consolidation

**Purpose**: Consolidate release and implementation documentation into CHANGELOG.md

**Analysis**:
- `CHANGELOG.md` - Already comprehensive with v2.0.0 and v2.1.0 entries
- `RELEASE_NOTES_v2.0.0.md` - Detailed release notes for v2.0.0
- `IMPLEMENTATION_SUMMARY.md` - Development summary for v2.0.0 features
- `SURFACE_USE_CASE_COMPLETION_SUMMARY.md` - Development summary for use case feature

**Decision**: 
The CHANGELOG.md already contains the essential information from the release notes. The detailed implementation summaries and release notes are development artifacts that can be removed since:
1. The CHANGELOG captures all user-facing changes
2. Git history preserves the implementation details
3. The detailed summaries are overly verbose for ongoing reference

**Action**: Remove redundant documentation files

### Component 3: History Directory Removal

**Purpose**: Remove IDE-generated history directory from repository

**Target**: `.history/` directory

**Rationale**: 
- This is generated by the Local History VSCode extension
- Contains duplicate file versions already tracked by git
- Adds unnecessary bloat to repository
- Should be excluded via .gitignore

**Actions**:
1. Remove `.history/` directory
2. Add `.history/` to .gitignore
3. Verify it's not tracked by git

### Component 4: Test Organization

**Purpose**: Organize test scripts in appropriate test directories

**Current State**:
- 4 test scripts in root directory
- `tests/` directory exists with proper structure

**Target Structure**:
```
tests/
├── unit/
│   └── test_yaml_parser.sh (moved from root)
├── integration/
│   ├── test_pattern_loading.sh (moved from root)
│   ├── test_use_case_metadata.sh (moved from root)
│   └── test_use_case_simple.sh (moved from root)
└── run_all_tests.sh (update to include new tests)
```

**Classification Logic**:
- `test_yaml_parser.sh` → unit test (tests specific parsing function)
- `test_pattern_loading.sh` → integration test (tests pattern loading workflow)
- `test_use_case_metadata.sh` → integration test (tests metadata extraction)
- `test_use_case_simple.sh` → integration test (tests use case display)

### Component 5: Examples Directory Evaluation

**Purpose**: Determine if examples directory should be kept or removed

**Current State**:
- `examples/` directory exists
- Contains only `README.md` with example invocations
- No actual code examples or sample projects

**Decision**: Keep the directory

**Rationale**: 
The examples/README.md provides valuable usage patterns and workflows. While it doesn't contain code samples, it serves as a practical guide for users. The directory structure is appropriate and the content is useful.

### Component 6: .gitignore Enhancement

**Purpose**: Ensure all unnecessary files are properly excluded

**Current .gitignore**:
```
__pycache__/
*.py[cod]
venv/
.env
.pytest_cache/
*.log
.DS_Store
.history/
```

**Analysis**: Already includes `.DS_Store` and `.history/`, which is correct.

**Action**: Verify .gitignore is sufficient (no changes needed)

## Data Models

### File Operations Matrix

| File | Action | Destination | Reason |
|------|--------|-------------|--------|
| TODO.md | Remove | N/A | Only completed items |
| IMPLEMENTATION_SUMMARY.md | Remove | N/A | Development artifact |
| SURFACE_USE_CASE_COMPLETION_SUMMARY.md | Remove | N/A | Development artifact |
| RELEASE_NOTES_v2.0.0.md | Remove | N/A | Redundant with CHANGELOG |
| .DS_Store | Remove | N/A | System file |
| .history/ | Remove | N/A | IDE artifact |
| test_pattern_loading.sh | Move | tests/integration/ | Integration test |
| test_use_case_metadata.sh | Move | tests/integration/ | Integration test |
| test_use_case_simple.sh | Move | tests/integration/ | Integration test |
| test_yaml_parser.sh | Move | tests/unit/ | Unit test |

### Directory Structure (After Cleanup)

```
claude-agents/
├── .claude/                    # Agent and skill definitions
├── .git/                       # Git repository data
├── .kiro/                      # Kiro specs and configuration
├── archive/                    # Legacy implementations
├── data/                       # Pattern definitions
├── docs/                       # Additional documentation
├── examples/                   # Usage examples (kept)
├── scripts/                    # Utility scripts
├── tests/                      # All test files
│   ├── fixtures/
│   ├── integration/            # Integration tests (4 new files)
│   ├── unit/                   # Unit tests (1 new file)
│   ├── README.md
│   └── run_all_tests.sh        # Updated test runner
├── .gitignore                  # Git ignore rules
├── CHANGELOG.md                # Version history
├── CLAUDE_CODE_USAGE.md        # Usage guide
├── GETTING_STARTED.md          # Getting started guide
└── README.md                   # Main documentation
```

## Error Handling

### File Operation Errors

**Scenario**: File cannot be deleted or moved
**Handling**: 
- Check if file exists before attempting operation
- Log error message with specific file path
- Continue with other operations
- Report summary of failures at end

### Git Tracking Issues

**Scenario**: .history directory still tracked by git after removal
**Handling**:
- Use `git rm -r --cached .history/` to untrack
- Verify with `git status`
- Document in implementation notes

### Test Script Path Updates

**Scenario**: Moving test scripts may break references
**Handling**:
- Search for references to moved test scripts in documentation
- Update `tests/run_all_tests.sh` to include new test locations
- Verify tests still execute correctly after move

## Testing Strategy

### Verification Steps

1. **File Removal Verification**
   - Confirm removed files no longer exist
   - Verify git status shows deletions

2. **File Move Verification**
   - Confirm files exist in new locations
   - Verify files are executable (`chmod +x`)
   - Run moved test scripts to ensure they work

3. **Test Runner Verification**
   - Update `tests/run_all_tests.sh` if needed
   - Run full test suite to verify all tests execute
   - Confirm no broken references

4. **Documentation Verification**
   - Search for references to removed/moved files
   - Update any documentation that references old locations
   - Verify README and other docs are accurate

5. **Git Tracking Verification**
   - Run `git status` to see changes
   - Verify .history is not tracked
   - Confirm .gitignore is working

### Test Execution

After cleanup, run:
```bash
# Verify test scripts work in new locations
bash tests/run_all_tests.sh

# Check git status
git status

# Verify no .history files tracked
git ls-files | grep .history
```

Expected results:
- All tests pass
- No .history files in git tracking
- Clean git status with only intended changes

## Implementation Notes

### Order of Operations

1. Move test scripts first (preserve functionality)
2. Update test runner to include new locations
3. Verify tests still work
4. Remove documentation files
5. Remove .history directory
6. Remove .DS_Store
7. Verify .gitignore
8. Update any documentation references
9. Run verification tests

### Preservation Strategy

Before removing any files:
- Verify content is truly redundant
- Check for unique information not captured elsewhere
- Consider if content should be preserved in git history

### Documentation Updates

Files that may need updates after cleanup:
- `tests/README.md` - Update test file locations if referenced
- Main `README.md` - Verify no broken links
- `GETTING_STARTED.md` - Verify no references to removed files

## Design Decisions

### Decision 1: Remove vs Archive Implementation Summaries

**Options**:
1. Move to archive directory
2. Remove completely
3. Consolidate into CHANGELOG

**Choice**: Remove completely

**Rationale**: 
- Content is redundant with CHANGELOG
- Git history preserves the information
- Archive directory is for legacy code, not temporary docs
- Reduces repository clutter

### Decision 2: Test Script Organization

**Options**:
1. Keep all tests in root
2. Move all to tests/integration
3. Separate by unit vs integration

**Choice**: Separate by unit vs integration

**Rationale**:
- Follows testing best practices
- Makes test organization clear
- Easier to run specific test types
- Matches existing test directory structure

### Decision 3: Examples Directory

**Options**:
1. Remove (only has README)
2. Keep as-is
3. Add actual code examples

**Choice**: Keep as-is

**Rationale**:
- README provides valuable usage patterns
- Directory structure is appropriate
- No need to add code examples (documentation-focused project)
- Users benefit from the workflow examples

### Decision 4: RELEASE_NOTES_v2.0.0.md

**Options**:
1. Keep for historical reference
2. Remove (redundant with CHANGELOG)
3. Move to docs/

**Choice**: Remove

**Rationale**:
- CHANGELOG.md already has comprehensive v2.0.0 entry
- Detailed release notes are overly verbose
- Git tags and history preserve release information
- Reduces documentation maintenance burden
